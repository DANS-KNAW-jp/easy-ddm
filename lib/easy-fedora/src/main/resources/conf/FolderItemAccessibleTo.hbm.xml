<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <class name="nl.knaw.dans.easy.domain.dataset.item.FolderItemAccessibleTo">
        <subselect>
        <!-- This query was written for PostGreSQL. It may need to be rewritten if/when porting to another RDBM -->
           SELECT DISTINCT c.pid, m.accessible_to, c.pid || '_' || accessible_to id
           FROM  easy_folders c, easy_files m
           WHERE c.dataset_sid = m.dataset_sid
           AND   m.path LIKE c.path || '%'
        </subselect>
        <synchronize table="easy_files" />
        <synchronize table="easy_folders" />
        <id name="id" />
        <property name="folderSid" type="string" insert="false" update="false">
            <column name="pid" length="64" />
        </property>
        <property name="accessibleTo" type="nl.knaw.dans.easy.fedora.db.AccessibleToEnumUserType">
            <column name="accessible_to" length="32" />
        </property>
    </class>
</hibernate-mapping>
