<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">

<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">

	<appender name="A1" class="org.apache.log4j.FileAppender">
        <param name="File"   value="${easy.home}/logs/A1.log" />
        <param name="Append" value="false" />
        <layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="%t %-5p %c{2} - %m%n"/>
        </layout>
	</appender>

	<appender name="easy.drfa" class="org.apache.log4j.DailyRollingFileAppender">
    	<param name="file" 				value="${easy.home}/logs/easy-rest.log"/>
    	<param name="Append" 			value="true" />
		<param name="datePattern" 		value="'.'yyyy-MM-dd'.log'"/>
    	<layout class="org.apache.log4j.PatternLayout">
      		<param name="ConversionPattern" value="%p %d [%t] - %m%n"/>
    	</layout>
  	</appender>

	<appender name="easy.err" class="org.apache.log4j.RollingFileAppender">
        <param name="File"   			value="${easy.home}/logs/easy-rest-error.log" />
        <param name="Append" 			value="true" />
        <param name="MaxFileSize"       value="100MB"/>
        <param name="Threshold" 		value="warn"/>
        <layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="%p %d [%t] - %m [%M] # %C.(%F:%L)%n"/>
        </layout>
        <filter class="org.apache.log4j.varia.LevelRangeFilter">
             <param name="LevelMax" value="fatal"/>
             <param name="LevelMin" value="warn"/>
             <param name="AcceptOnMatch" value="true"/>
        </filter>
	</appender>
	
	<appender name="service.profiling" class="org.apache.log4j.RollingFileAppender">
        <param name="file"              value="${easy.home}/logs/easy-rest-service-profiling.csv"/>
        <param name="Append"            value="true" />
        <param name="MaxFileSize"       value="500KB"/>
        <param name="MaxBackupIndex"    value="5"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d;%m%n"/>
        </layout>
    </appender>
    
    <appender name="submission-error" class="org.apache.log4j.RollingFileAppender">
        <param name="file"              value="${easy.home}/logs/easy-rest-submission-error.log"/>
        <param name="Append"            value="true" />
        <param name="MaxFileSize"       value="5MB"/>
        <param name="MaxBackupIndex"    value="5"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d;%m%n"/>
        </layout>
        <filter class="org.apache.log4j.varia.LevelRangeFilter">
             <param name="LevelMax" value="fatal"/>
             <param name="LevelMin" value="warn"/>
             <param name="AcceptOnMatch" value="true"/>
        </filter>
    </appender>
    
    <appender name="SYSLOG" class="org.apache.log4j.net.SyslogAppender">
    	<param name="syslogHost" 		value="127.0.0.1"/>
    	<param name="Facility"			value="LOCAL1"/>
    	<param name="Threshold" 		value="DEBUG"/>
    	<layout class="org.apache.log4j.PatternLayout">
       </layout>
    </appender> 

	<category name="org.apache.log4j.xml">
		<priority value="debug" />
  		<appender-ref ref="A1" />
	</category>

	<logger name="nl.knaw.dans">
  		<level value="info"/>
	</logger>
	
	<logger name="nl.knaw.dans.easy.business.aspect.ServiceProfiling" additivity="false">
       <level value="info"/>
       <appender-ref ref="service.profiling"/>
    </logger>
    
    <logger name="nl.knaw.dans.easy.data.audit.SyslogAuditTrail" additivity="false">
	   <level value="debug"/>
	   <appender-ref ref="SYSLOG"/>
	</logger>
    
    <logger name="nl.knaw.dans.easy.business.dataset.SubmissionDispatcher">
       <appender-ref ref="submission-error"/>
    </logger>
	
	<logger name="nl.knaw.dans.easy.business.security.CodedAuthz">
  		<level value="info"/>
	</logger>
	
	<logger name="org.trippi.io">
		<level value="warn"/>
	</logger>
	
	<logger name="org.apache.wicket.markup.html.internal.Enclosure">
		<level value="error"/>
	</logger>

	<root>
	  <priority value="info" />
	  <appender-ref ref="easy.drfa" />
   	  <appender-ref ref="easy.err" />

	</root>

</log4j:configuration>